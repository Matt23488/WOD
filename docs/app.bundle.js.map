{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/ts/Application.ts","src/ts/Character/Character.ts","src/ts/Character/Damage.ts","src/ts/Character/Equipment.ts","src/ts/Character/InventoryItem.ts","src/ts/Character/Merit.ts","src/ts/Character/Note.ts","src/ts/Dice.ts","src/ts/main.ts","src/ts/utils.ts"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","Character_1","Dice_1","Application","prototype","goBack","this","mode","_previousSection","window","location","hash","newCharacter","characters","push","default","characterId","selectCharacter","character","indexOf","deleteCharacter","locked","confirm","name","id","remove","saveCharacters","localStorage","setItem","JSON","stringify","realCharacters","map","toJson","alert","downloadCharacter","json","dl","document","createElement","setAttribute","encodeURIComponent","style","display","body","appendChild","click","removeChild","uploadCharacter","_this","ul","type","accept","addEventListener","file","files","reader","FileReader","onload","target","result","fromJson","parse","readAsText","toggleCharacterLock","switchMode","getElementById","savedCharacters","getItem","unshift","ghost","ko","observable","observableArray","computed","filter","dice","lockButtonClass","lockButtonIcon","Damage_1","Equipment_1","InventoryItem_1","Merit_1","Note_1","utils_1","Character","firstNameLength","randomInteger","lastNameLength","firstName","lastName","newLetter","alphabet","charAt","toUpperCase","randomName","player","age","vice","virtue","origins","gender","concept","chronicle","intelligence","strength","presence","wits","dexterity","manipulation","resolve","stamina","composure","academics","robotics","crafts","investigation","medicine","occult","politics","science","athletics","brawl","drive","ranged","larceny","stealth","survival","weaponry","animalKen","empathy","expression","intimidation","persuasion","socialize","streetwise","subterfuge","merits","spells","flaws","size","armor","experience","morality","weapons","equipment","inventory","notes","onComponentClick","_","currentTarget","getElementsByTagName","focus","newItem","constructor","createLockable","removeItem","item","moveItem","direction","index","newIndex","splice","clearUsed","usedObservable","bashing","damage","lethal","aggravated","usedMagic","usedWillpower","m","value","s","w","description","quantity","extend","lockable","numeric","precision","min","max","speed","defense","Math","initiative","health","magic","subscribe","val","willpower","Damage","anyEmpty","totalHealth","addBashing","addLethal","addAggravated","clearAll","totalHealthObservable","Equipment","InventoryItem","getDisplayText","displayText","Merit","Note","Dice","incrementDicePool","amount","dicePool","rollDice","RollState","beginRoll","rollRounds","rollingInProgress","totalDiceSuccesses","reduce","total","d","totalDiceSuccessesDisplay","_diceObj","removeAll","_currentRoundRolls","_currentRoundResults","_intervalHandle","setInterval","nextRoll","_nextRoundRolls","critMessage","classList","add","innerText","getElementsByClassName","_currentDice","replace","_currentRound","clearInterval","diceObj","Application_1","applyCustomKnockoutCode","constructors","Object","defineProperty","app","toggleTooltips","enable","$","tooltip","applyBindings","outerWidth","randomFloat","minInclusive","maxExclusive","_a","random","floor","bindingHandlers","update","element","valueAccessor","divs","newRound","rolls","span","delay","animation","spans","j","roll","backgroundImage","innerHTML","damageDisplay","init","damageObj","attribute","dots","dot","dataset","toggle","title","forEach","clearDot","backgroundColor","borderColor","readOnlyAttribute","hideUnfilled","used","focusOnCreation","setTimeout","extenders","pureComputed","read","write","newValue","notifySubscribers","notify","args","Infinity","current","roundingMultiplier","pow","newValueAsNum","isNaN","valueToWrite","round"],"mappings":"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","file":"app.bundle.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","import Character from \"./Character/Character\";\r\nimport Dice from \"./Dice\";\r\nimport swal from \"sweetalert\";\r\n\r\nexport default class Application {\r\n    public mode: KnockoutObservable<string>;\r\n    public characterId: KnockoutObservable<number>;\r\n    public characters: KnockoutObservableArray<Character>;\r\n    public realCharacters: KnockoutComputed<Array<Character>>;\r\n    public character: KnockoutComputed<Character>;\r\n    public dice: Dice;\r\n    public lockButtonClass: KnockoutComputed<string>;\r\n    public lockButtonIcon: KnockoutComputed<string>;\r\n    private _previousSection: string;\r\n\r\n    public constructor() {\r\n        const savedCharacters: Array<Character> = (JSON.parse(window.localStorage.getItem(\"characters\")) || []).map(Character.fromJson);\r\n        savedCharacters.unshift(Character.newCharacter());\r\n        savedCharacters[0].ghost = true;\r\n\r\n        this.mode = ko.observable(\"list\");\r\n        this.characterId = ko.observable(0);\r\n        this.characters = ko.observableArray(savedCharacters);\r\n        this.realCharacters = ko.computed(() => this.characters().filter(c => !c.ghost), this);\r\n        this.character = ko.computed(() => this.characters()[this.characterId()], this);\r\n        this.dice = new Dice();\r\n        this.lockButtonClass = ko.computed(() => this.character().locked() ? \"btn-danger\" : \"btn-outline-success\", this);\r\n        this.lockButtonIcon = ko.computed(() => this.character().locked() ? \"fas fa-lock\" : \"fas fa-lock-open\", this);\r\n        this._previousSection = null;\r\n    }\r\n\r\n    public goBack(): void {\r\n        if (this.mode() === \"sheet\") this.mode(\"list\");\r\n        else {\r\n            this.mode(\"sheet\");\r\n\r\n            if (this._previousSection) window.location.hash = this._previousSection;\r\n        }\r\n    }\r\n\r\n    public newCharacter(): void {\r\n        this.characters.push(Character.newCharacter());\r\n        this.characterId(this.characters().length - 1);\r\n        this.mode(\"sheet\");\r\n    }\r\n\r\n    public selectCharacter(character: Character): void {\r\n        this.characterId(this.characters.indexOf(character));\r\n        this.mode(\"sheet\");\r\n    }\r\n\r\n    public deleteCharacter(character: Character): void {\r\n        // swal({\r\n        //     title: `Delete ${this.character().name()}`,\r\n        //     text: \"Are you sure? (As long as you don't save, your character won't be gone.)\",\r\n        //     icon: \"warning\",\r\n        //     buttons: [\"Cancel\", \"Delete\"],\r\n        //     dangerMode: true\r\n        // })\r\n        // .then((willDelete: boolean) => {\r\n        //     if (willDelete) {\r\n        //         const id = this.characterId();\r\n        //         this.characterId(0);\r\n        //         this.characters.remove(this.characters()[id]);\r\n        //         this.mode(\"list\");\r\n        //     }\r\n        // });\r\n        if (this.character().locked()) return;\r\n        if (confirm(`Are you sure you want to delete ${this.character().name()}? (As long as you don't save, your character won't be gone.)`)) {\r\n            const id = this.characterId();\r\n            this.characterId(0);\r\n            this.characters.remove(this.characters()[id]);\r\n            this.mode(\"list\");\r\n        }\r\n    }\r\n\r\n    public saveCharacters(): void {\r\n        window.localStorage.setItem(\"characters\", JSON.stringify(this.realCharacters().map(c => c.toJson())));\r\n        // swal(\"Characters saved successfully!\", {\r\n        //     buttons: [],\r\n        //     timer: 1000,\r\n        //     icon: \"success\"\r\n        // });\r\n        alert(\"Characters saved successfully!\");\r\n    }\r\n\r\n    public downloadCharacter(): void {\r\n        const json = JSON.stringify(this.character().toJson());\r\n\r\n        const dl = document.createElement(\"a\");\r\n        dl.setAttribute(\"href\", `data:text/plain;charset=utf-8,${encodeURIComponent(json)}`);\r\n        dl.setAttribute(\"download\", `${this.character().name()}.json`);\r\n\r\n        dl.style.display = \"none\";\r\n        document.body.appendChild(dl);\r\n\r\n        dl.click();\r\n\r\n        document.body.removeChild(dl);\r\n    }\r\n\r\n    public uploadCharacter(): void {\r\n        const ul = document.createElement(\"input\");\r\n        ul.type = \"file\";\r\n        ul.accept = \".json\";\r\n        ul.style.display = \"none\";\r\n\r\n        ul.addEventListener(\"change\", e => {\r\n            const file = ul.files[0];\r\n            if (!file) return;\r\n\r\n            const reader = new FileReader();\r\n            reader.onload = (e: any) => {\r\n                const json = e.target.result;\r\n                this.characters.push(Character.fromJson(JSON.parse(json)));\r\n                this.characterId(this.characters().length - 1);\r\n                this.mode(\"sheet\");\r\n            };\r\n            reader.readAsText(file);\r\n        });\r\n\r\n        document.body.appendChild(ul);\r\n\r\n        ul.click();\r\n\r\n        document.body.removeChild(ul);\r\n    }\r\n\r\n    public toggleCharacterLock(): void {\r\n        const character = this.character();\r\n        character.locked(!character.locked());\r\n    }\r\n\r\n    public switchMode(mode: string): () => void {\r\n        return () => {\r\n            if (this.mode() !== \"list\" && document.getElementById(mode)) {\r\n                this._previousSection = mode;\r\n            }\r\n            else this._previousSection = null;\r\n\r\n            window.location.hash = \"\";\r\n            this.mode(mode);\r\n        }\r\n    }\r\n}","import Damage from \"./Damage\";\r\nimport Equipment from \"./Equipment\";\r\nimport InventoryItem from \"./InventoryItem\";\r\nimport Merit from \"./Merit\";\r\nimport Note from \"./Note\";\r\nimport { randomInteger } from \"../utils\";\r\n\r\nexport default class Character {\r\n    public ghost: boolean = false;\r\n    public locked: KnockoutObservable<boolean> = ko.observable(true);\r\n\r\n    public name: KnockoutObservable<string>;\r\n    public player: KnockoutObservable<string>;\r\n    public age: KnockoutObservable<number>;\r\n    public vice: KnockoutObservable<string>;\r\n    public virtue: KnockoutObservable<string>;\r\n    public origins: KnockoutObservable<string>;\r\n    public gender: KnockoutObservable<string>;\r\n    public concept: KnockoutObservable<string>;\r\n    public chronicle: KnockoutObservable<string>;\r\n\r\n    public intelligence: KnockoutObservable<number>;\r\n    public strength: KnockoutObservable<number>;\r\n    public presence: KnockoutObservable<number>;\r\n    public wits: KnockoutObservable<number>;\r\n    public dexterity: KnockoutObservable<number>;\r\n    public manipulation: KnockoutObservable<number>;\r\n    public resolve: KnockoutObservable<number>;\r\n    public stamina: KnockoutObservable<number>;\r\n    public composure: KnockoutObservable<number>;\r\n\r\n    public academics: KnockoutObservable<number>;\r\n    public robotics: KnockoutObservable<number>;\r\n    public crafts: KnockoutObservable<number>;\r\n    public investigation: KnockoutObservable<number>;\r\n    public medicine: KnockoutObservable<number>;\r\n    public occult: KnockoutObservable<number>;\r\n    public politics: KnockoutObservable<number>;\r\n    public science: KnockoutObservable<number>;\r\n    \r\n    public athletics: KnockoutObservable<number>;\r\n    public brawl: KnockoutObservable<number>;\r\n    public drive: KnockoutObservable<number>;\r\n    public ranged: KnockoutObservable<number>;\r\n    public larceny: KnockoutObservable<number>;\r\n    public stealth: KnockoutObservable<number>;\r\n    public survival: KnockoutObservable<number>;\r\n    public weaponry: KnockoutObservable<number>;\r\n\r\n    public animalKen: KnockoutObservable<number>;\r\n    public empathy: KnockoutObservable<number>;\r\n    public expression: KnockoutObservable<number>;\r\n    public intimidation: KnockoutObservable<number>;\r\n    public persuasion: KnockoutObservable<number>;\r\n    public socialize: KnockoutObservable<number>;\r\n    public streetwise: KnockoutObservable<number>;\r\n    public subterfuge: KnockoutObservable<number>;\r\n\r\n    public merits: KnockoutObservableArray<Merit>;\r\n    public spells: KnockoutObservableArray<Merit>;\r\n    public flaws: KnockoutObservableArray<Merit>;\r\n\r\n    public size: KnockoutObservable<number>;\r\n    public speed: KnockoutComputed<number>;\r\n    public defense: KnockoutComputed<number>;\r\n    public armor: KnockoutObservable<number>;\r\n    public initiative: KnockoutComputed<number>;\r\n    public experience: KnockoutObservable<number>;\r\n    public morality: KnockoutObservable<number>;\r\n\r\n    public weapons: KnockoutObservableArray<Equipment>;\r\n    public equipment: KnockoutObservableArray<Equipment>;\r\n    public inventory: KnockoutObservableArray<InventoryItem>;\r\n\r\n    public notes: KnockoutObservableArray<Note>;\r\n\r\n    public health: KnockoutComputed<number>;\r\n    public damage: Damage;\r\n\r\n    public magic: KnockoutComputed<number>;\r\n    public usedMagic: KnockoutObservable<number>;\r\n\r\n    public willpower: KnockoutComputed<number>;\r\n    public usedWillpower: KnockoutObservable<number>;\r\n\r\n    public constructor(json: CharacterJson) {\r\n        this.name = ko.observable(json.name).extend({ lockable: this.locked });\r\n        this.player = ko.observable(json.player).extend({ lockable: this.locked });\r\n        this.age = ko.observable(json.age).extend({ numeric: { precision: 0 }, lockable: this.locked });\r\n        this.vice = ko.observable(json.vice).extend({ lockable: this.locked });\r\n        this.virtue = ko.observable(json.virtue).extend({ lockable: this.locked });\r\n        this.origins = ko.observable(json.origins).extend({ lockable: this.locked });\r\n        this.gender = ko.observable(json.gender).extend({ lockable: this.locked });\r\n        this.concept = ko.observable(json.concept).extend({ lockable: this.locked });\r\n        this.chronicle = ko.observable(json.chronicle).extend({ lockable: this.locked });\r\n\r\n        this.intelligence = ko.observable(json.intelligence).extend({ lockable: this.locked });\r\n        this.strength = ko.observable(json.strength).extend({ lockable: this.locked });\r\n        this.presence = ko.observable(json.presence).extend({ lockable: this.locked });\r\n        this.wits = ko.observable(json.wits).extend({ lockable: this.locked });\r\n        this.dexterity = ko.observable(json.dexterity).extend({ lockable: this.locked });\r\n        this.manipulation = ko.observable(json.manipulation).extend({ lockable: this.locked });\r\n        this.resolve = ko.observable(json.resolve).extend({ lockable: this.locked });\r\n        this.stamina = ko.observable(json.stamina).extend({ lockable: this.locked });\r\n        this.composure = ko.observable(json.composure).extend({ lockable: this.locked });\r\n\r\n        this.academics = ko.observable(json.academics).extend({ lockable: this.locked });\r\n        this.robotics = ko.observable(json.robotics).extend({ lockable: this.locked });\r\n        this.crafts = ko.observable(json.crafts).extend({ lockable: this.locked });\r\n        this.investigation = ko.observable(json.investigation).extend({ lockable: this.locked });\r\n        this.medicine = ko.observable(json.medicine).extend({ lockable: this.locked });\r\n        this.occult = ko.observable(json.occult).extend({ lockable: this.locked });\r\n        this.politics = ko.observable(json.politics).extend({ lockable: this.locked });\r\n        this.science = ko.observable(json.science).extend({ lockable: this.locked });\r\n\r\n        this.athletics = ko.observable(json.athletics).extend({ lockable: this.locked });\r\n        this.brawl = ko.observable(json.brawl).extend({ lockable: this.locked });\r\n        this.drive = ko.observable(json.drive).extend({ lockable: this.locked });\r\n        this.ranged = ko.observable(json.ranged).extend({ lockable: this.locked });\r\n        this.larceny = ko.observable(json.larceny).extend({ lockable: this.locked });\r\n        this.stealth = ko.observable(json.stealth).extend({ lockable: this.locked });\r\n        this.survival = ko.observable(json.survival).extend({ lockable: this.locked });\r\n        this.weaponry = ko.observable(json.weaponry).extend({ lockable: this.locked });\r\n\r\n        this.animalKen = ko.observable(json.animalKen).extend({ lockable: this.locked });\r\n        this.empathy = ko.observable(json.empathy).extend({ lockable: this.locked });\r\n        this.expression = ko.observable(json.expression).extend({ lockable: this.locked });\r\n        this.intimidation = ko.observable(json.intimidation).extend({ lockable: this.locked });\r\n        this.persuasion = ko.observable(json.persuasion).extend({ lockable: this.locked });\r\n        this.socialize = ko.observable(json.socialize).extend({ lockable: this.locked });\r\n        this.streetwise = ko.observable(json.streetwise).extend({ lockable: this.locked });\r\n        this.subterfuge = ko.observable(json.subterfuge).extend({ lockable: this.locked });\r\n\r\n        this.merits = ko.observableArray(json.merits.map(m => new Merit(m.name, m.value, this.locked)));\r\n        this.spells = ko.observableArray(json.spells.map(s => new Merit(s.name, s.value, this.locked)));\r\n        this.flaws = ko.observableArray(json.flaws.map(f => new Merit(f.name, f.value, this.locked)));\r\n\r\n        this.size = ko.observable(json.size).extend({ numeric: { precision: 0, min: 1, max: 10 }, lockable: this.locked });\r\n        this.speed = ko.computed(() => this.strength() + this.dexterity() + 5, this);\r\n        this.defense = ko.computed(() => Math.min(this.dexterity(), this.wits()), this);\r\n        this.armor = ko.observable(json.armor).extend({ numeric: { precision: 0 } }).extend({ lockable: this.locked });\r\n        this.initiative = ko.computed(() => this.dexterity() + this.composure(), this);\r\n        this.experience = ko.observable(json.experience).extend({ numeric: { precision: 0 }, lockable: this.locked });\r\n        this.morality = ko.observable(json.morality).extend({ numeric: { precision: 0, min: 1, max: 10 }, lockable: this.locked });\r\n\r\n        this.weapons = ko.observableArray(json.weapons.map(w => new Equipment(w.name, w.description, this.locked)));\r\n        this.equipment = ko.observableArray(json.equipment.map(e => new Equipment(e.name, e.description, this.locked)));\r\n        this.inventory = ko.observableArray(json.inventory.map(i => new InventoryItem(i.name, i.description, i.quantity, this.locked)));\r\n\r\n        this.notes = ko.observableArray(json.notes.map(n => new Note(n, this.locked)));\r\n\r\n        this.health = ko.computed(() => this.stamina() + this.size(), this);\r\n        this.damage = new Damage(this.health, json.bashing, json.lethal, json.aggravated, this.locked);\r\n\r\n        this.magic = ko.computed(() => this.resolve() + this.composure(), this);\r\n        this.usedMagic = ko.observable(json.usedMagic || 0).extend({ lockable: this.locked });\r\n        this.magic.subscribe(val => {\r\n            if (this.usedMagic() > val) this.usedMagic(val);\r\n        }, this);\r\n\r\n        this.willpower = ko.computed(() => this.resolve() + this.composure(), this);\r\n        this.usedWillpower = ko.observable(json.usedWillpower || 0).extend({ lockable: this.locked });\r\n        this.willpower.subscribe(val => {\r\n            if (this.usedWillpower() > val) this.usedWillpower(val);\r\n        }, this);\r\n    }\r\n\r\n    public static newCharacter(): Character {\r\n        return new Character({\r\n            name: randomName(),\r\n            player: \"\",\r\n            age: 0,\r\n            vice: \"\",\r\n            virtue: \"\",\r\n            origins: \"\",\r\n            gender: \"\",\r\n            concept: \"\",\r\n            chronicle: \"\",\r\n\r\n            intelligence: 1,\r\n            strength: 1,\r\n            presence: 1,\r\n            wits: 1,\r\n            dexterity: 1,\r\n            manipulation: 1,\r\n            resolve: 1,\r\n            stamina: 1,\r\n            composure: 1,\r\n\r\n            academics: 0,\r\n            robotics: 0,\r\n            crafts: 0,\r\n            investigation: 0,\r\n            medicine: 0,\r\n            occult: 0,\r\n            politics: 0,\r\n            science: 0,\r\n\r\n            athletics: 0,\r\n            brawl: 0,\r\n            drive: 0,\r\n            ranged: 0,\r\n            larceny: 0,\r\n            stealth: 0,\r\n            survival: 0,\r\n            weaponry: 0,\r\n\r\n            animalKen: 0,\r\n            empathy: 0,\r\n            expression: 0,\r\n            intimidation: 0,\r\n            persuasion: 0,\r\n            socialize: 0,\r\n            streetwise: 0,\r\n            subterfuge: 0,\r\n\r\n            merits: [],\r\n            spells: [],\r\n            flaws: [],\r\n\r\n            size: 5,\r\n            armor: 0,\r\n            experience: 0,\r\n            morality: 7,\r\n\r\n            weapons: [],\r\n            equipment: [],\r\n            inventory: [],\r\n\r\n            notes: []\r\n        });\r\n    }\r\n\r\n    public static fromJson(json: CharacterJson): Character {\r\n        return new Character(json);\r\n    }\r\n\r\n    public onComponentClick(_: any, e: Event): void {\r\n        const element = <HTMLElement>e.currentTarget;\r\n        element.getElementsByTagName(\"input\")[0].focus();\r\n    }\r\n\r\n    public newItem<T>(observableArray: KnockoutObservableArray<T>, constructor: { createLockable(locked: KnockoutObservable<boolean>): T}): () => void {\r\n        return () => {\r\n            if (this.locked()) return;\r\n            observableArray.push(constructor.createLockable(this.locked));\r\n        };\r\n    }\r\n\r\n    public removeItem<T>(observableArray: KnockoutObservableArray<T>): (item: T) => void {\r\n        return (item: T) => {\r\n            if (this.locked()) return;\r\n            observableArray.remove(item);\r\n        };\r\n    }\r\n\r\n    public moveItem<T>(observableArray: KnockoutObservableArray<T>, direction: number): (item: T) => void {\r\n        return (item: T) => {\r\n            if (this.locked()) return;\r\n            const index = observableArray.indexOf(item);\r\n            const newIndex = index + direction;\r\n\r\n            if (newIndex < 0 || newIndex >= observableArray().length) return;\r\n\r\n            observableArray.splice(index, 1);\r\n            observableArray.splice(newIndex, 0, item);\r\n        };\r\n    }\r\n\r\n    public clearUsed(usedObservable: KnockoutObservable<number>): () => void {\r\n        return () => {\r\n            usedObservable(0);\r\n        };\r\n    }\r\n\r\n    public toJson(): CharacterJson {\r\n        return {\r\n            name: this.name(),\r\n            player: this.player(),\r\n            age: this.age(),\r\n            vice: this.vice(),\r\n            virtue: this.virtue(),\r\n            origins: this.origins(),\r\n            gender: this.gender(),\r\n            concept: this.concept(),\r\n            chronicle: this.chronicle(),\r\n\r\n            intelligence: this.intelligence(),\r\n            wits: this.wits(),\r\n            resolve: this.resolve(),\r\n            strength: this.strength(),\r\n            dexterity: this.dexterity(),\r\n            stamina: this.stamina(),\r\n            presence: this.presence(),\r\n            manipulation: this.manipulation(),\r\n            composure: this.composure(),\r\n\r\n            bashing: this.damage.bashing(),\r\n            lethal: this.damage.lethal(),\r\n            aggravated: this.damage.aggravated(),\r\n            usedMagic: this.usedMagic(),\r\n            usedWillpower: this.usedWillpower(),\r\n\r\n            academics: this.academics(),\r\n            robotics: this.robotics(),\r\n            crafts: this.crafts(),\r\n            investigation: this.investigation(),\r\n            medicine: this.medicine(),\r\n            occult: this.occult(),\r\n            politics: this.politics(),\r\n            science: this.science(),\r\n\r\n            athletics: this.athletics(),\r\n            brawl: this.brawl(),\r\n            drive: this.drive(),\r\n            ranged: this.ranged(),\r\n            larceny: this.larceny(),\r\n            stealth: this.stealth(),\r\n            survival: this.survival(),\r\n            weaponry: this.weaponry(),\r\n\r\n            animalKen: this.animalKen(),\r\n            empathy: this.empathy(),\r\n            expression: this.expression(),\r\n            intimidation: this.intimidation(),\r\n            persuasion: this.persuasion(),\r\n            socialize: this.socialize(),\r\n            streetwise: this.streetwise(),\r\n            subterfuge: this.subterfuge(),\r\n\r\n            merits: this.merits().map(m => { return { name: m.name(), value: m.value() }; }),\r\n            spells: this.spells().map(s => { return { name: s.name(), value: s.value() }; }),\r\n            flaws: this.flaws().map(f => { return { name: f.name(), value: f.value() }; }),\r\n\r\n            size: this.size(),\r\n            armor: this.armor(),\r\n            experience: this.experience(),\r\n            morality: this.morality(),\r\n\r\n            weapons: this.weapons().map(w => { return { name: w.name(), description: w.description() }; }),\r\n            equipment: this.equipment().map(e => { return { name: e.name(), description: e.description() }; }),\r\n            inventory: this.inventory().map(i => { return { name: i.name(), description: i.description(), quantity: i.quantity() }; }),\r\n\r\n            notes: this.notes().map(n => n.value())\r\n        };\r\n    }\r\n}\r\n\r\nconst alphabet = \"abcdefghijklmnopqrstuvwxyz\";\r\nfunction randomName() {\r\n    const firstNameLength = randomInteger(5, 12);\r\n    const lastNameLength = randomInteger(5, 12);\r\n    let firstName = \"\";\r\n    let lastName = \"\";\r\n\r\n    for (let i = 0; i < firstNameLength; i++) {\r\n        let newLetter = alphabet.charAt(randomInteger(0, alphabet.length));\r\n        if (i === 0) newLetter = newLetter.toUpperCase();\r\n\r\n        firstName += newLetter;\r\n    }\r\n\r\n    for (let i = 0; i < lastNameLength; i++) {\r\n        let newLetter = alphabet.charAt(randomInteger(0, alphabet.length));\r\n        if (i === 0) newLetter = newLetter.toUpperCase();\r\n\r\n        lastName += newLetter;\r\n    }\r\n\r\n    return `${firstName} ${lastName}`;\r\n}\r\n\r\ntype CharacterJson = {\r\n    name: string,\r\n    player: string,\r\n    age: number,\r\n    vice: string,\r\n    virtue: string,\r\n    origins: string,\r\n    gender: string,\r\n    concept: string,\r\n    chronicle: string,\r\n\r\n    intelligence: number,\r\n    strength: number,\r\n    presence: number,\r\n    wits: number,\r\n    dexterity: number,\r\n    manipulation: number,\r\n    resolve: number,\r\n    stamina: number,\r\n    composure: number,\r\n\r\n    academics: number,\r\n    robotics: number,\r\n    crafts: number,\r\n    investigation: number,\r\n    medicine: number,\r\n    occult: number,\r\n    politics: number,\r\n    science: number,\r\n\r\n    athletics: number,\r\n    brawl: number,\r\n    drive: number,\r\n    ranged: number,\r\n    larceny: number,\r\n    stealth: number,\r\n    survival: number,\r\n    weaponry: number,\r\n\r\n    animalKen: number,\r\n    empathy: number,\r\n    expression: number,\r\n    intimidation: number,\r\n    persuasion: number,\r\n    socialize: number,\r\n    streetwise: number,\r\n    subterfuge: number,\r\n\r\n    merits: Array<{ name: string, value: number }>,\r\n    spells: Array<{ name: string, value: number }>,\r\n    flaws: Array<{ name: string, value: number }>,\r\n\r\n    size: number,\r\n    armor: number,\r\n    experience: number,\r\n    morality: number,\r\n\r\n    weapons: Array<{ name: string, description: string }>,\r\n    equipment: Array<{ name: string, description: string }>,\r\n    inventory: Array<{ name: string, description: string, quantity: number }>,\r\n\r\n    notes: Array<string>,\r\n\r\n    bashing?: number,\r\n    lethal?: number,\r\n    aggravated?: number,\r\n\r\n    usedMagic?: number,\r\n    usedWillpower?: number\r\n};","export default class Damage {\r\n    public totalHealth: KnockoutComputed<number>;\r\n    public bashing: KnockoutObservable<number>;\r\n    public lethal: KnockoutObservable<number>;\r\n    public aggravated: KnockoutObservable<number>;\r\n\r\n    public constructor(totalHealthObservable: KnockoutComputed<number>, bashing?: number, lethal?: number, aggravated?: number, locked?: KnockoutObservable<boolean>) {\r\n        this.totalHealth = totalHealthObservable;\r\n        this.bashing = ko.observable(bashing || 0);\r\n        this.lethal = ko.observable(lethal || 0);\r\n        this.aggravated = ko.observable(aggravated || 0);\r\n\r\n        if (locked) {\r\n            this.bashing = this.bashing.extend({ lockable: locked });\r\n            this.lethal = this.lethal.extend({ lockable: locked });\r\n            this.aggravated = this.aggravated.extend({ lockable: locked });\r\n        }\r\n\r\n        totalHealthObservable.subscribe(val => {\r\n            while (this.bashing() + this.lethal() + this.aggravated() > val) {\r\n                if (this.bashing() > 0) {\r\n                    this.bashing(this.bashing() - 1);\r\n                }\r\n                else if (this.lethal() > 0) {\r\n                    this.lethal(this.lethal() - 1);\r\n                }\r\n                else {\r\n                    this.aggravated(this.aggravated() - 1);\r\n                }\r\n            }\r\n        }, this);\r\n    }\r\n\r\n    public anyEmpty(): boolean {\r\n        return this.bashing() + this.lethal() + this.aggravated() < this.totalHealth();\r\n    }\r\n\r\n    public addBashing(): void {\r\n        if (this.anyEmpty()) {\r\n            this.bashing(this.bashing() + 1);\r\n        }\r\n        else if (this.bashing() > 0) {\r\n            this.bashing(this.bashing() - 1);\r\n            this.lethal(this.lethal() + 1);\r\n        }\r\n        else if (this.lethal() > 0) {\r\n            this.lethal(this.lethal() - 1);\r\n            this.aggravated(this.aggravated() + 1);\r\n        }\r\n        else {\r\n            alert(\"you ded\");\r\n        }\r\n    }\r\n\r\n    public addLethal(): void {\r\n        if (this.anyEmpty()) {\r\n            this.lethal(this.lethal() + 1);\r\n        }\r\n        else if (this.bashing() > 0) {\r\n            this.bashing(this.bashing() - 1);\r\n            this.lethal(this.lethal() + 1);\r\n        }\r\n        else if (this.lethal() > 0) {\r\n            this.lethal(this.lethal() - 1);\r\n            this.aggravated(this.aggravated() + 1);\r\n        }\r\n        else {\r\n            alert(\"you ded\");\r\n        }\r\n    }\r\n\r\n    public addAggravated(): void {\r\n        if (this.anyEmpty()) {\r\n            this.aggravated(this.aggravated() + 1);\r\n        }\r\n        else if (this.bashing() > 0) {\r\n            this.bashing(this.bashing() - 1);\r\n            this.aggravated(this.aggravated() + 1);\r\n        }\r\n        else if (this.lethal() > 0) {\r\n            this.lethal(this.lethal() - 1);\r\n            this.aggravated(this.aggravated() + 1);\r\n        }\r\n        else {\r\n            alert(\"you ded\");\r\n        }\r\n    }\r\n\r\n    public clearAll(): void {\r\n        this.bashing(0);\r\n        this.lethal(0);\r\n        this.aggravated(0);\r\n    }\r\n}","export default class Equipment {\r\n    public name: KnockoutObservable<string>;\r\n    public description: KnockoutObservable<string>;\r\n\r\n    public constructor(name?: string, description?: string, locked?: KnockoutObservable<boolean>) {\r\n        this.name = ko.observable(name || \"\");\r\n        this.description = ko.observable(description || \"\");\r\n\r\n        if (locked) {\r\n            this.name = this.name.extend({ lockable: locked });\r\n            this.description = this.description.extend({ lockable: locked });\r\n        }\r\n    }\r\n\r\n    public static createLockable(locked: KnockoutObservable<boolean>) {\r\n        return new Equipment(null, null, locked);\r\n    }\r\n}","export default class InventoryItem {\r\n    public name: KnockoutObservable<string>;\r\n    public description: KnockoutObservable<string>;\r\n    public quantity: KnockoutObservable<number>;\r\n    public displayText: KnockoutComputed<string>;\r\n\r\n    public constructor(name?: string, description?: string, quantity?: number, locked?: KnockoutObservable<boolean>) {\r\n        this.name = ko.observable(name || \"\");\r\n        this.description = ko.observable(description || \"\");\r\n        this.quantity = ko.observable(quantity || 1);\r\n\r\n        if (locked) {\r\n            this.name = this.name.extend({ lockable: locked });\r\n            this.description = this.description.extend({ lockable: locked });\r\n            this.quantity = this.quantity.extend({ lockable: locked });\r\n        }\r\n\r\n        this.displayText = ko.computed(this.getDisplayText, this);\r\n    }\r\n\r\n    public getDisplayText() : string {\r\n        return `${this.quantity()} ${this.name()}`;\r\n    }\r\n\r\n    public static createLockable(locked: KnockoutObservable<boolean>) {\r\n        return new InventoryItem(null, null, null, locked);\r\n    }\r\n}","export default class Merit {\r\n    public name: KnockoutObservable<string>;\r\n    public value: KnockoutObservable<number>;\r\n\r\n    public constructor(name?: string, value?: number, locked?: KnockoutObservable<boolean>) {\r\n        this.name = ko.observable(name || \"\");\r\n        this.value = ko.observable(value || 0);\r\n\r\n        if (locked) {\r\n            this.name = this.name.extend({ lockable: locked });\r\n            this.value = this.value.extend({ lockable: locked });\r\n        }\r\n    }\r\n\r\n    public static createLockable(locked: KnockoutObservable<boolean>) {\r\n        return new Merit(null, null, locked);\r\n    }\r\n}","export default class Note {\r\n    public value: KnockoutObservable<string>;\r\n\r\n    public constructor(value?: string, locked?: KnockoutObservable<boolean>) {\r\n        this.value = ko.observable(value || \"\");\r\n\r\n        if (locked) {\r\n            this.value = this.value.extend({ lockable: locked });\r\n        }\r\n    }\r\n\r\n    public static createLockable(locked: KnockoutObservable<boolean>) {\r\n        return new Note(null, locked);\r\n    }\r\n}","import { randomFloat, randomInteger } from \"./utils\";\r\n\r\nexport default class Dice {\r\n    public dicePool: KnockoutObservable<number>;\r\n    public rollRounds: KnockoutObservableArray<Array<number>>;\r\n    public rollingInProgress: KnockoutObservable<boolean>;\r\n    public totalDiceSuccesses: KnockoutComputed<number>;\r\n    public totalDiceSuccessesDisplay: KnockoutComputed<string>;\r\n\r\n    public constructor() {\r\n        this.dicePool = ko.observable(1);\r\n        this.rollRounds = ko.observableArray([]);\r\n        this.rollingInProgress = ko.observable(false);\r\n        this.totalDiceSuccesses = ko.computed(() => {\r\n            if (this.rollingInProgress() || this.rollRounds().length === 0) return -1;\r\n\r\n            return this.rollRounds().reduce((total: number, r: Array<number>) => {\r\n                return total + r.reduce((total: number, d: number) => total + (d > 7 ? 1 : 0), 0);\r\n            }, 0);\r\n        }, this);\r\n        this.totalDiceSuccessesDisplay = ko.computed(() => {\r\n            return this.totalDiceSuccesses() >= 0 ? \"\" + this.totalDiceSuccesses() : \"???\";\r\n        }, this);\r\n    }\r\n\r\n    public incrementDicePool(amount: number): () => void {\r\n        return () => {\r\n            this.dicePool(this.dicePool() + amount);\r\n        };\r\n    }\r\n\r\n    public rollDice(): void {\r\n        const roller = new RollState(this);\r\n        roller.beginRoll();\r\n    }\r\n}\r\n\r\nclass RollState {\r\n    private _diceObj: Dice;\r\n    private _currentRound: number;\r\n    private _currentDice: number;\r\n    private _currentRoundRolls: number;\r\n    private _currentRoundResults: Array<number>;\r\n    private _nextRoundRolls: number;\r\n    private _intervalHandle: number;\r\n\r\n    public constructor(diceObj: Dice) {\r\n        this._diceObj = diceObj;\r\n        this._currentRound = 0;\r\n        this._currentDice = 0;\r\n        this._currentRoundRolls = diceObj.dicePool();\r\n        this._currentRoundResults = [];\r\n        this._nextRoundRolls = 0;\r\n        this._intervalHandle = null;\r\n    }\r\n\r\n    public beginRoll(): void {\r\n        this._diceObj.rollingInProgress(true);\r\n        this._diceObj.rollRounds.removeAll();\r\n        for (let i = 0; i < this._currentRoundRolls; i++) this._currentRoundResults.push(-1);\r\n        this._diceObj.rollRounds.push(this._currentRoundResults);\r\n\r\n        this._intervalHandle = window.setInterval(() => {\r\n            const nextRoll = randomInteger(1, 11);\r\n            if (nextRoll === 10) {\r\n                this._nextRoundRolls++;\r\n                let critMessage = document.getElementById(\"critMessage\");\r\n                if (critMessage) {\r\n                    critMessage.remove();\r\n                }\r\n                critMessage = document.createElement(\"div\");\r\n                critMessage.classList.add(\"crit-message\");\r\n                critMessage.innerText = \"Crit!\";\r\n                critMessage.id = \"critMessage\";\r\n                document.getElementsByClassName(\"diceContainer\")[0].appendChild(critMessage);\r\n            }\r\n            this._currentRoundResults[this._currentDice] = nextRoll;\r\n            this._diceObj.rollRounds.replace(this._diceObj.rollRounds()[this._currentRound], this._currentRoundResults);\r\n            this._currentDice++;\r\n\r\n            if (this._currentDice === this._currentRoundRolls) {\r\n                if (this._nextRoundRolls === 0) {\r\n                    window.clearInterval(this._intervalHandle);\r\n                    this._diceObj.rollingInProgress(false);\r\n                    const critMessage = document.getElementById(\"critMessage\");\r\n                    if (critMessage) {\r\n                        critMessage.remove();\r\n                    }\r\n                    return;\r\n                }\r\n                else {\r\n                    this._currentRound++;\r\n                    this._currentRoundRolls = this._nextRoundRolls;\r\n                    this._nextRoundRolls = 0;\r\n                    this._currentDice = 0;\r\n                    this._currentRoundResults = [];\r\n                    for (let i = 0; i < this._currentRoundRolls; i++) this._currentRoundResults.push(-1);\r\n                    this._diceObj.rollRounds.push(this._currentRoundResults);\r\n                }\r\n            }\r\n        }, 250);\r\n    }\r\n}","import Application from \"./Application\";\r\nimport Equipment from \"./Character/Equipment\";\r\nimport InventoryItem from \"./Character/InventoryItem\";\r\nimport Merit from \"./Character/Merit\";\r\nimport Note from \"./Character/Note\";\r\nimport { applyCustomKnockoutCode } from \"./utils\";\r\n\r\napplyCustomKnockoutCode();\r\n\r\nconst constructors = {\r\n    Equipment: Equipment,\r\n    InventoryItem: InventoryItem,\r\n    Merit: Merit,\r\n    Note: Note\r\n};\r\nObject.defineProperty(window, \"constructors\", { value: constructors });\r\n\r\nconst app = new Application();\r\nko.applyBindings(app);\r\n\r\n// Exposing the view model to the global state in case manual changes need to be applied\r\nObject.defineProperty(window, \"app\", { value: app });\r\n\r\nfunction toggleTooltips(enable: boolean): void {\r\n    if (enable) $(\"[data-toggle='tooltip']\").tooltip();\r\n    else $(\"[data-toggle='tooltip']\").tooltip(\"dispose\");\r\n}\r\n\r\nwindow.addEventListener(\"resize\", () => {\r\n    toggleTooltips(window.outerWidth >= 992);\r\n});\r\ntoggleTooltips(window.outerWidth >= 992);","import Damage from \"./Character/Damage\";\r\n\r\nexport function randomInteger(minInclusive = 0, maxExclusive = 10): number {\r\n    if (maxExclusive < minInclusive) {\r\n        [minInclusive, maxExclusive] = [maxExclusive, minInclusive];\r\n    }\r\n\r\n    return Math.floor(Math.random() * (maxExclusive - minInclusive)) + minInclusive;\r\n}\r\n\r\nexport function randomFloat(minInclusive = 0, maxExclusive = 1): number {\r\n    if (maxExclusive < minInclusive) {\r\n        [minInclusive, maxExclusive] = [maxExclusive, minInclusive];\r\n    }\r\n\r\n    return Math.random() * (maxExclusive - minInclusive) + minInclusive;\r\n}\r\n\r\nexport function applyCustomKnockoutCode() {\r\n    ko.bindingHandlers.dice = {\r\n        update: (element: HTMLElement, valueAccessor: () => KnockoutObservableArray<Array<number>>) => {\r\n            const rollRounds = valueAccessor()();\r\n            if (rollRounds.length === 0) {\r\n                element.innerHTML = \"\";\r\n                return;\r\n            }\r\n    \r\n            let divs = element.getElementsByClassName(\"dice-round\");\r\n            if (divs.length !== rollRounds.length) {\r\n                const newRound = document.createElement(\"div\");\r\n                newRound.classList.add(\"dice-round\");\r\n                const rolls = rollRounds[rollRounds.length - 1];\r\n                for (let i = 0; i < rolls.length; i++) {\r\n                    const span = document.createElement(\"span\");\r\n                    const delay = randomFloat(0, 0.5);\r\n                    span.style.animation = `rollingDice 0.5s linear -${delay}s infinite alternate`;\r\n                    span.classList.add(\"dice\");\r\n                    newRound.appendChild(span);\r\n                }\r\n                element.appendChild(newRound);\r\n                divs = element.getElementsByClassName(\"dice-round\");\r\n            }\r\n    \r\n            for (let i = 0; i < rollRounds.length; i++) {\r\n                const rolls = rollRounds[i];\r\n                const spans = divs[i].getElementsByClassName(\"dice\");\r\n                for (let j = 0; j < rolls.length; j++) {\r\n                    const roll = rolls[j];\r\n                    const span = <HTMLSpanElement>spans[j];\r\n    \r\n                    if (roll !== -1) {\r\n                        span.style.animation = null;\r\n                        span.style.backgroundImage = `url('images/dice-${roll}.png')`;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    ko.bindingHandlers.damageDisplay = {\r\n        init: (element: HTMLElement) => {\r\n            for (let i = 0; i < 15; i++) {\r\n                const span = document.createElement(\"span\");\r\n                span.classList.add(\"damage\");\r\n                span.classList.add(\"none\");\r\n                element.appendChild(span);\r\n            }\r\n        },\r\n        update: (element: HTMLElement, valueAccessor: () => Damage) => {\r\n            const damageObj = valueAccessor();\r\n            const spans = element.getElementsByTagName(\"span\");\r\n            for (let i = 0; i < spans.length; i++) {\r\n                if (i < damageObj.aggravated()) {\r\n                    spans[i].classList.remove(\"none\");\r\n                    spans[i].classList.remove(\"bashing\");\r\n                    spans[i].classList.remove(\"lethal\");\r\n                    spans[i].classList.add(\"aggravated\");\r\n                }\r\n                else if (i - damageObj.aggravated() < damageObj.lethal()) {\r\n                    spans[i].classList.remove(\"none\");\r\n                    spans[i].classList.remove(\"bashing\");\r\n                    spans[i].classList.remove(\"aggravated\");\r\n                    spans[i].classList.add(\"lethal\");\r\n                }\r\n                else if (i - damageObj.aggravated() - damageObj.lethal() < damageObj.bashing()) {\r\n                    spans[i].classList.remove(\"none\");\r\n                    spans[i].classList.remove(\"lethal\");\r\n                    spans[i].classList.remove(\"aggravated\");\r\n                    spans[i].classList.add(\"bashing\");\r\n                }\r\n                else {\r\n                    spans[i].classList.remove(\"bashing\");\r\n                    spans[i].classList.remove(\"lethal\");\r\n                    spans[i].classList.remove(\"aggravated\");\r\n                    spans[i].classList.add(\"none\");\r\n                }\r\n    \r\n                if (i < damageObj.totalHealth()) {\r\n                    spans[i].classList.remove(\"HIDDEN\");\r\n                }\r\n                else {\r\n                    spans[i].classList.add(\"HIDDEN\");\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    ko.bindingHandlers.attribute = {\r\n        init: (element: HTMLElement, valueAccessor: () => { value: KnockoutObservable<number>, max: number }) => {\r\n            const dots: Array<HTMLSpanElement> = [];\r\n            for (let i = 0; i < valueAccessor().max; i++) {\r\n                const dot = document.createElement(\"span\");\r\n                dot.classList.add(\"attribute-dot\");\r\n                dot.classList.add(\"pointer\");\r\n                dot.dataset.toggle = \"tooltip\";\r\n                dot.title = \"\" + (i + 1);\r\n                $(dot).tooltip();\r\n    \r\n                dots.push(dot);\r\n    \r\n                dot.addEventListener(\"pointerenter\", () => {\r\n                    dots.forEach((dot: HTMLSpanElement, index: number) => {\r\n                        if (index <= i) dot.classList.add(\"hoverFilled\");\r\n                    });\r\n                });\r\n                dot.addEventListener(\"pointerleave\", () => {\r\n                    dots.forEach((dot: HTMLSpanElement) => {\r\n                        dot.classList.remove(\"hoverFilled\");\r\n                    });\r\n                });\r\n            }\r\n    \r\n            const clearDot = document.createElement(\"div\");\r\n            clearDot.classList.add(\"clear-dot\");\r\n            clearDot.innerHTML = \"&times;\";\r\n            clearDot.dataset.toggle = \"tooltip\";\r\n            clearDot.title = \"Clear\";\r\n            clearDot.addEventListener(\"click\", () => {\r\n                valueAccessor().value(0);\r\n            });\r\n            element.appendChild(clearDot);\r\n            $(clearDot).tooltip();\r\n    \r\n            dots.forEach((dot: HTMLSpanElement, index: number) => {\r\n                element.appendChild(dot);\r\n                dot.addEventListener(\"click\", () => {\r\n                    valueAccessor().value(index + 1);\r\n                });\r\n            });\r\n        },\r\n        update: (element: HTMLElement, valueAccessor: () => { value: KnockoutObservable<number>, max: number }) => {\r\n            const value = valueAccessor().value();\r\n            const dots = element.getElementsByClassName(\"attribute-dot\");\r\n            for (let i = 0; i < dots.length; i++) {\r\n                const dot = <HTMLSpanElement>dots[i];\r\n                dot.style.backgroundColor = null;\r\n                dot.style.borderColor = null;\r\n                if (i < value) {\r\n                    dot.style.backgroundColor = \"var(--body-color)\";\r\n                    dot.style.borderColor = \"var(--body-color)\";\r\n                }\r\n            }\r\n        }\r\n    };\r\n    \r\n    ko.bindingHandlers.readOnlyAttribute = {\r\n        init: (element: HTMLElement, valueAccessor: () => { value: KnockoutObservable<number>, max: number }) => {\r\n            for (let i = 0; i < valueAccessor().max; i++) {\r\n                const dot = document.createElement(\"span\");\r\n                dot.classList.add(\"attribute-dot\");\r\n                element.appendChild(dot);\r\n            }\r\n        },\r\n        update: (element: HTMLElement, valueAccessor: () => { value: KnockoutObservable<number>, max: number, hideUnfilled?: boolean }) => {\r\n            const value = valueAccessor().value();\r\n            const dots = element.getElementsByTagName(\"span\");\r\n            for (let i = 0; i < dots.length; i++) {\r\n                dots[i].classList.remove(\"filled\");\r\n                if (i < value) {\r\n                    dots[i].classList.add(\"filled\");\r\n                    dots[i].classList.remove(\"HIDDEN\");\r\n                }\r\n                else if (valueAccessor().hideUnfilled) {\r\n                    dots[i].classList.add(\"HIDDEN\");\r\n                }\r\n            }\r\n        }\r\n    };\r\n    \r\n    ko.bindingHandlers.used = {\r\n        init: (element: HTMLElement, valueAccessor: () => { value: KnockoutObservable<number>, total: KnockoutComputed<number> }) => {\r\n            const dots: Array<HTMLSpanElement> = [];\r\n            for (let i = 0; i < 12; i++) {\r\n                const dot = document.createElement(\"span\");\r\n                dot.classList.add(\"attribute-dot\");\r\n                element.appendChild(dot);\r\n    \r\n                dots.push(dot);\r\n    \r\n                dot.addEventListener(\"pointerenter\", () => {\r\n                    dots.forEach((dot: HTMLSpanElement, index: number) => {\r\n                        if (index <= i) dot.classList.add(\"hoverFilled\");\r\n                    });\r\n                });\r\n                dot.addEventListener(\"pointerleave\", () => {\r\n                    dots.forEach((dot: HTMLSpanElement) => {\r\n                        dot.classList.remove(\"hoverFilled\");\r\n                    });\r\n                });\r\n            }\r\n            dots.forEach((dot: HTMLSpanElement, index: number) => {\r\n                dot.addEventListener(\"click\", () => {\r\n                    valueAccessor().value(index + 1);\r\n                });\r\n            });\r\n        },\r\n        update: (element: HTMLElement, valueAccessor: () => { value: KnockoutObservable<number>, total: KnockoutComputed<number> }) => {\r\n            const used = valueAccessor().value();\r\n            const total = valueAccessor().total();\r\n            const dots = element.getElementsByTagName(\"span\");\r\n            for (let i = 0; i < dots.length; i++) {\r\n                if (i < used) dots[i].classList.add(\"filled-red\");\r\n                else dots[i].classList.remove(\"filled-red\");\r\n    \r\n                if (i < total) dots[i].classList.remove(\"HIDDEN\");\r\n                else dots[i].classList.add(\"HIDDEN\");\r\n            }\r\n        }\r\n    };\r\n    \r\n    ko.bindingHandlers.focusOnCreation = {\r\n        init: (element: HTMLInputElement | HTMLTextAreaElement) => {\r\n            window.setTimeout(() => {\r\n                if (element.value) return;\r\n                element.focus();\r\n            }, 1);\r\n        }\r\n    };\r\n    \r\n    (<any>ko.extenders).lockable = (target: any, locked: KnockoutObservable<boolean>) => {\r\n        const result = ko.pureComputed({\r\n            read: target,\r\n            write: (newValue: any) => {\r\n                if (locked()) {\r\n                    target.notifySubscribers(target());\r\n                }\r\n                else {\r\n                    target(newValue);\r\n                    target.notifySubscribers(newValue);\r\n                }\r\n            }\r\n        }).extend({ notify: \"always\" });\r\n    \r\n        return result;\r\n    };\r\n    \r\n    (<any>ko.extenders).numeric = (target: any, args: { precision?: number, min?: number, max?: number }) => {\r\n        const precision = args.precision || 0;\r\n        const min = args.min || -Infinity;\r\n        const max = args.max || Infinity;\r\n    \r\n        // Create a writeable computed observable to intercept writes to our observable\r\n        const result = ko.pureComputed({\r\n            read: target, // Always return the original observable's value\r\n            write: (newValue: any) => {\r\n                const current = target();\r\n                const roundingMultiplier = Math.pow(10, precision);\r\n                const newValueAsNum = isNaN(newValue) ? 0 : +newValue;\r\n                let valueToWrite = Math.round(newValueAsNum * roundingMultiplier) / roundingMultiplier;\r\n                if (valueToWrite < min) valueToWrite = min;\r\n                else if (valueToWrite > max) valueToWrite = max;\r\n    \r\n                // Only write if it changed\r\n                if (valueToWrite !== current) {\r\n                    target(valueToWrite);\r\n                }\r\n                else {\r\n                    // If the rounded value is the same, but a different value was written,\r\n                    // force a notification for the current field\r\n                    if (newValue !== current) {\r\n                        target.notifySubscribers(valueToWrite);\r\n                    }\r\n                }\r\n            }\r\n        }).extend({ notify: \"always\" });\r\n    \r\n        // Initialize with current value to make sure it is rounded appropriately\r\n        result(target());\r\n    \r\n        // Return the new computed observable\r\n        return result;\r\n    };\r\n}"]}